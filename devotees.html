<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Devotees â€” DC Franchise Database</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .search-container {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      margin-bottom: 24px;
      align-items: center;
    }

    .search-input {
      padding: 12px 16px;
      border: 1px solid rgba(125,76,255,.35);
      background: rgba(0,0,0,.2);
      border-radius: 10px;
      color: var(--text);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(125,76,255,.2);
      background: rgba(0,0,0,.3);
    }

    .search-input::placeholder {
      color: rgba(255,255,255,.5);
    }

    .sort-dropdown {
      padding: 10px 14px;
      border: 1px solid rgba(125,76,255,.35);
      background: rgba(0,0,0,.2);
      border-radius: 8px;
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .sort-dropdown:hover, .sort-dropdown:focus {
      border-color: var(--accent);
      background: rgba(0,0,0,.3);
    }

    .player-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }

    .player-card {
      background: linear-gradient(135deg, rgba(125,76,255,.1), rgba(255,179,71,.05));
      border: 1px solid rgba(125,76,255,.2);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .player-card:hover {
      transform: translateY(-4px);
      border-color: var(--accent);
      box-shadow: 0 8px 24px rgba(125,76,255,.2);
    }

    .player-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      margin: 0 auto 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: 700;
    }

    .player-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--accent2);
    }

    .player-meta {
      font-size: 12px;
      color: rgba(255,255,255,.7);
      line-height: 1.6;
    }

    .loading-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }

    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }

    .no-results h2 {
      color: var(--text);
      margin-bottom: 8px;
    }

    .stats-bar {
      background: rgba(0,0,0,.2);
      border: 1px solid rgba(125,76,255,.2);
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 16px;
    }
  </style>
</head>
<body>

<!-- SITE HEADER START -->
<header class="modern-header" id="modernHeader">
  <div class="header-container">
    <div class="header-top">
      <a href="index.html" class="brand-section" aria-label="Go to home">
        <div class="brand-icon">
          <span class="brand-logo-text">âš¡</span>
        </div>
        <div class="brand-content">
          <h1>DC <span class="brand-gradient">Franchise</span> Database</h1>
          <p class="brand-subtitle">Dynamic player profiles â€¢ Powered by JSON â€¢ Search & sort enabled</p>
        </div>
      </a>
      <div class="stats-badge">
        <div class="stats-main"><span id="totalSeasons">5</span> Seasons â€¢ <span id="totalPlayers">58</span> Players</div>
        <div class="stats-sub">Icons: <span id="iconFormat">name.png</span></div>
      </div>
    </div>
    <nav class="header-nav" aria-label="Primary navigation">
      <ul class="nav-list">
        <li class="nav-item"><a href="index.html" class="nav-link" data-page="index"><span class="nav-icon">ğŸ </span><span>Home</span></a></li>
        <li class="nav-item"><a href="current-season.html" class="nav-link" data-page="current-season"><span class="nav-icon">ğŸ“Š</span><span>Current Season</span></a></li>
        <li class="nav-item"><a href="voting-analytics.html" class="nav-link" data-page="voting-analytics"><span class="nav-icon">ğŸ—³ï¸</span><span>Voting Analytics</span></a></li>
        <li class="nav-item"><a href="franchise.html" class="nav-link" data-page="franchise"><span class="nav-icon">ğŸ›ï¸</span><span>Franchise</span></a></li>
        <li class="nav-item"><a href="rankings.html" class="nav-link" data-page="rankings"><span class="nav-icon">ğŸ†</span><span>Rankings</span></a></li>
        <li class="nav-item"><a href="seasons.html" class="nav-link" data-page="seasons"><span class="nav-icon">ğŸ“š</span><span>Seasons</span></a></li>
        <li class="nav-item"><a href="devotees.html" class="nav-link active" data-page="devotees"><span class="nav-icon">ğŸ‘¥</span><span>Players</span></a></li>
        <li class="nav-item"><a href="awards.html" class="nav-link" data-page="awards"><span class="nav-icon">ğŸ¥‡</span><span>Awards</span></a></li>
      </ul>
    </nav>
  </div>
</header>

<script>
  if (window.SITECONFIG) {
    document.getElementById('totalSeasons').textContent = window.SITECONFIG.seasons;
    document.getElementById('totalPlayers').textContent = window.SITECONFIG.players;
    document.getElementById('iconFormat').textContent = window.SITECONFIG.iconFormat;
  }
  
  const header = document.getElementById('modernHeader');
  if (header) {
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      if (currentScroll > 20) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    }, { passive: true });
  }
  
  const currentPage = window.location.pathname.split('/').pop() || 'index.html';
  const navLinks = document.querySelectorAll('.nav-link');
  navLinks.forEach(link => {
    const linkPage = link.getAttribute('href');
    if (linkPage === currentPage || (currentPage === '' && linkPage === 'index.html')) {
      link.classList.add('active');
    }
  });
</script>
<!-- SITE HEADER END -->

<div class="container">
  <div class="topbar">
    <div>
      <div class="brand">DC <span>Franchise</span> Database</div>
      <div class="meta">Devotees</div>
    </div>
    <div class="meta">68 total players â€¢ 68 appearances</div>
  </div>

  <div class="tabs">
    <a class="tab" href="index.html">ğŸ  Home</a>
    <a class="tab" href="current-season.html">ğŸ“Š Current Season</a>
    <a class="tab" href="voting-analytics.html">ğŸ—³ï¸ Voting Analytics</a>
    <a class="tab active" href="devotees.html">ğŸ‘¥ All Players</a>
    <a class="tab" href="rankings.html">ğŸ† Rankings</a>
    <a class="tab" href="seasons.html">ğŸ“š Seasons</a>
    <a class="tab" href="awards.html">ğŸ¥‡ Awards</a>
  </div>

  <div style="margin: 32px 0;">
    <h2 style="margin-bottom: 16px;">ğŸ‘¥ All Players</h2>
    <p style="color: var(--muted); margin-bottom: 24px;">Browse the complete roster of Total Drama contestants</p>

    <div class="search-container">
      <input 
        type="text" 
        id="searchInput" 
        class="search-input" 
        placeholder="ğŸ” Search players by name..." 
        aria-label="Search players"
      >
      <select id="sortSelect" class="sort-dropdown" aria-label="Sort players">
        <option value="best-placement">ğŸ“ˆ Best Placement (1st â†’ Last)</option>
        <option value="worst-placement">ğŸ“‰ Worst Placement (Last â†’ 1st)</option>
        <option value="name-asc">ğŸ”¤ Name (A â†’ Z)</option>
        <option value="name-desc">ğŸ”¤ Name (Z â†’ A)</option>
        <option value="seasons-most">ğŸ“… Seasons (Most â†’ Fewest)</option>
        <option value="seasons-least">ğŸ“… Seasons (Fewest â†’ Most)</option>
        <option value="votes-most">ğŸ—³ï¸ Votes Against (Most â†’ Fewest)</option>
        <option value="votes-least">ğŸ—³ï¸ Votes Against (Fewest â†’ Most)</option>
        <option value="challenges-most">ğŸ… Challenge Wins (Most â†’ Fewest)</option>
        <option value="challenges-least">ğŸ… Challenge Wins (Fewest â†’ Most)</option>
      </select>
    </div>

    <div class="stats-bar">
      <span id="resultCount">Showing 0 of 68 players</span>
    </div>

    <div id="playerContainer" class="player-grid">
      <div class="loading-state">
        <h2>â³ Loading players...</h2>
        <p>Please wait while we fetch the player database</p>
      </div>
    </div>
  </div>
</div>

<!-- SITE FOOTER -->
<footer class="siteFooter">
  <div class="footerInner">
    <div class="footerTitle">DC Franchise Database</div>
    <div class="footerSub">40 total players across 4 seasons â€¢ 68 total appearances</div>
  </div>
</footer>

<script>
let allPlayers = [];
let filteredPlayers = [];

async function loadPlayers() {
  try {
    const response = await fetch('players_database.json');
    if (!response.ok) throw new Error('Failed to load players');
    allPlayers = await response.json();
    filteredPlayers = [...allPlayers];
    renderPlayers();
    attachEventListeners();
  } catch (error) {
    console.error('Error loading players:', error);
    document.getElementById('playerContainer').innerHTML = `
      <div class="no-results">
        <h2>âš ï¸ Error Loading Players</h2>
        <p>${error.message}</p>
      </div>
    `;
  }
}

function filterPlayers() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
  
  if (searchTerm === '') {
    // If search is empty, show all players
    filteredPlayers = [...allPlayers];
  } else {
    // Filter by search term
    filteredPlayers = allPlayers.filter(player => 
      player.name.toLowerCase().includes(searchTerm)
    );
  }
  
  // Re-apply current sort
  const sortValue = document.getElementById('sortSelect').value;
  sortPlayers(sortValue);
  renderPlayers();
}

function sortPlayers(sortValue) {
  switch(sortValue) {
    case 'best-placement':
      filteredPlayers.sort((a, b) => (a.bestPlacement || 999) - (b.bestPlacement || 999));
      break;
    case 'worst-placement':
      filteredPlayers.sort((a, b) => (b.bestPlacement || 0) - (a.bestPlacement || 0));
      break;
    case 'name-asc':
      filteredPlayers.sort((a, b) => a.name.localeCompare(b.name));
      break;
    case 'name-desc':
      filteredPlayers.sort((a, b) => b.name.localeCompare(a.name));
      break;
    case 'seasons-most':
      filteredPlayers.sort((a, b) => (b.seasons || []).length - (a.seasons || []).length);
      break;
    case 'seasons-least':
      filteredPlayers.sort((a, b) => (a.seasons || []).length - (b.seasons || []).length);
      break;
    case 'votes-most':
      filteredPlayers.sort((a, b) => (b.totalVotes || 0) - (a.totalVotes || 0));
      break;
    case 'votes-least':
      filteredPlayers.sort((a, b) => (a.totalVotes || 0) - (b.totalVotes || 0));
      break;
    case 'challenges-most':
      filteredPlayers.sort((a, b) => (b.challengeWins || 0) - (a.challengeWins || 0));
      break;
    case 'challenges-least':
      filteredPlayers.sort((a, b) => (a.challengeWins || 0) - (b.challengeWins || 0));
      break;
    default:
      break;
  }
}

function renderPlayers() {
  const container = document.getElementById('playerContainer');
  const resultCount = document.getElementById('resultCount');
  
  resultCount.textContent = `Showing ${filteredPlayers.length} of ${allPlayers.length} players`;
  
  if (filteredPlayers.length === 0) {
    container.innerHTML = `
      <div class="no-results">
        <h2>No players found</h2>
        <p>Try adjusting your search term</p>
      </div>
    `;
    return;
  }
  
  container.innerHTML = filteredPlayers.map(player => `
    <a href="player.html?player=${player.playerSlug}" class="player-card" style="text-decoration: none; color: inherit;">
      <div class="player-avatar">${player.name.charAt(0)}</div>
      <div class="player-name">${player.name}</div>
      <div class="player-meta">
        <div>ğŸ¬ ${(player.seasons || []).length} season${(player.seasons || []).length !== 1 ? 's' : ''}</div>
        <div>ğŸ† Avg: #${player.bestPlacement || 'N/A'}</div>
        <div>ğŸ—³ï¸ ${player.totalVotes || 0} votes</div>
        <div>âš¡ ${player.challengeWins || 0} wins</div>
      </div>
    </a>
  `).join('');
}

function attachEventListeners() {
  const searchInput = document.getElementById('searchInput');
  const sortSelect = document.getElementById('sortSelect');
  
  // Search input event - fires on every character typed or deleted
  searchInput.addEventListener('input', filterPlayers);
  
  // Sort dropdown event
  sortSelect.addEventListener('change', (e) => {
    sortPlayers(e.target.value);
    renderPlayers();
  });
}

// Load players on page load
loadPlayers();
</script>

</body>
</html>
