<!doctype html>
<html lang="en" data-root=".">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>DC Franchise ‚Äî Players</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Advanced Modern Design for Devotees */
    
    .devotees-hero {
      text-align: center;
      padding: 50px 20px;
      background: linear-gradient(135deg, rgba(125,76,255,.2), rgba(255,179,71,.15), rgba(76,255,179,.1));
      border-radius: 28px;
      border: 1px solid rgba(125,76,255,.35);
      margin-bottom: 32px;
      position: relative;
      overflow: hidden;
    }
    
    .devotees-hero::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(125,76,255,.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .devotees-hero h1 {
      position: relative;
      font-size: 48px;
      margin: 0 0 16px;
      background: linear-gradient(135deg, #fff, var(--accent2), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 40px rgba(125,76,255,.5);
    }
    
    .devotees-hero p {
      position: relative;
      color: var(--muted);
      font-size: 16px;
      margin: 0;
    }
    
    .controls {
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.15);
      border-radius: 20px;
      padding: 20px;
      margin: 24px 0;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0,0,0,.2);
    }
    
    input[type="search"] {
      background: rgba(0,0,0,.3);
      border: 2px solid rgba(125,76,255,.3);
      transition: all 0.3s ease;
    }
    
    input[type="search"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(125,76,255,.15);
      transform: scale(1.02);
    }
    
    select {
      background: rgba(0,0,0,.3);
      border: 2px solid rgba(255,179,71,.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    select:hover {
      border-color: var(--accent2);
      transform: scale(1.02);
    }
    
    #count {
      text-align: center;
      padding: 12px;
      background: linear-gradient(90deg, transparent, rgba(125,76,255,.15), transparent);
      border-radius: 12px;
      font-weight: 700;
      color: var(--accent2);
      margin-bottom: 20px !important;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }
    
    .card {
      position: relative;
      background: linear-gradient(135deg, rgba(255,255,255,.1), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.15);
      border-radius: 20px;
      padding: 20px;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      overflow: hidden;
      text-decoration: none;
      color: inherit;
      display: block;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.1), transparent);
      transition: left 0.5s ease;
    }
    
    .card:hover::before {
      left: 100%;
    }
    
    .card:hover {
      transform: translateY(-12px) scale(1.03);
      border-color: var(--accent);
      box-shadow: 
        0 20px 60px rgba(125,76,255,.4),
        0 0 0 1px rgba(125,76,255,.3),
        inset 0 1px 0 rgba(255,255,255,.2);
      background: linear-gradient(135deg, rgba(125,76,255,.15), rgba(255,179,71,.1));
    }
    
    .card.winner {
      border: 2px solid var(--accent2);
      background: linear-gradient(135deg, rgba(255,179,71,.15), rgba(125,76,255,.1));
      position: relative;
    }
    
    .card.winner::after {
      content: 'üëë';
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 32px;
      opacity: 0.3;
      transition: all 0.3s ease;
    }
    
    .card.winner:hover::after {
      opacity: 1;
      transform: scale(1.2) rotate(15deg);
    }
    
    .card.winner:hover {
      border-color: var(--accent2);
      box-shadow: 
        0 20px 60px rgba(255,179,71,.5),
        0 0 0 2px rgba(255,179,71,.4),
        inset 0 1px 0 rgba(255,255,255,.3);
    }
    
    .player-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(125,76,255,.3), rgba(255,179,71,.2));
      border: 3px solid var(--accent);
      overflow: hidden;
      position: relative;
      flex: 0 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 
        0 8px 16px rgba(0,0,0,.3),
        inset 0 2px 4px rgba(255,255,255,.2);
      transition: all 0.3s ease;
    }
    
    .card:hover .player-avatar {
      transform: scale(1.1) rotate(5deg);
      border-color: var(--accent2);
      box-shadow: 
        0 12px 24px rgba(125,76,255,.5),
        inset 0 2px 4px rgba(255,255,255,.3);
    }
    
    .player-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .card:hover .player-avatar img {
      transform: scale(1.1);
    }
    
    .player-avatar .fallback {
      font-weight: 800;
      font-size: 32px;
      position: absolute;
      display: none;
    }
    
    .row {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;
    }
    
    .name {
      font-weight: 900;
      font-size: 20px;
      color: var(--text);
      margin-bottom: 6px;
      transition: all 0.3s ease;
    }
    
    .card:hover .name {
      color: var(--accent2);
      transform: translateX(4px);
    }
    
    .sub {
      color: var(--muted);
      font-size: 13px;
      font-weight: 500;
    }
    
    .badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    
    .badge {
      background: rgba(0,0,0,.4);
      border: 1px solid rgba(255,255,255,.15);
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 700;
      color: var(--muted);
      transition: all 0.3s ease;
    }
    
    .card:hover .badge {
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.3);
    }
    
    .badge.gold {
      background: linear-gradient(135deg, rgba(255,179,71,.3), rgba(255,179,71,.15));
      border-color: var(--accent2);
      color: var(--accent2);
      box-shadow: 0 4px 12px rgba(255,179,71,.3);
    }
    
    .badge.purple {
      background: linear-gradient(135deg, rgba(125,76,255,.3), rgba(125,76,255,.15));
      border-color: var(--accent);
      color: var(--accent);
      box-shadow: 0 4px 12px rgba(125,76,255,.3);
    }
    
    .badge.good {
      background: linear-gradient(135deg, rgba(76,255,179,.3), rgba(76,255,179,.15));
      border-color: rgba(76,255,179,.7);
      color: rgba(76,255,179,.9);
      box-shadow: 0 4px 12px rgba(76,255,179,.3);
    }
  </style>
</head>
<body>

<!-- SITE HEADER START -->
<header class="modern-header" id="modernHeader">
  <div class="header-container">
    <!-- Top Bar -->
    <div class="header-top">
      <a href="index.html" class="brand-section" aria-label="Go to home">
        <div class="brand-icon">
          <span class="brand-logo-text">‚ö°</span>
        </div>
        <div class="brand-content">
          <h1>DC <span class="brand-gradient">Franchise</span> Database</h1>
          <p class="brand-subtitle">Season <span id="currentSeasonNum">5</span> Live ‚Ä¢ Click to Explore</p>
        </div>
      </a>

      <div class="stats-badge">
        <div class="stats-main"><span id="totalSeasons">5</span> Seasons ‚Ä¢ <span id="totalPlayers">58</span> Players</div>
        <div class="stats-sub">Icons: <span id="iconFormat">name.png</span></div>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="header-nav" aria-label="Primary navigation">
      <ul class="nav-list">
        <li class="nav-item">
          <a href="index.html" class="nav-link" data-page="index">
            <span class="nav-icon">üè†</span>
            <span>Home</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="current-season.html" class="nav-link" data-page="current-season">
            <span class="nav-icon">üìä</span>
            <span>Current Season</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="voting-analytics.html" class="nav-link" data-page="voting-analytics">
            <span class="nav-icon">üßæ</span>
            <span>Voting Analytics</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="franchise.html" class="nav-link" data-page="franchise">
            <span class="nav-icon">üèõÔ∏è</span>
            <span>Franchise</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="rankings.html" class="nav-link" data-page="rankings">
            <span class="nav-icon">üèÜ</span>
            <span>Rankings</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="seasons.html" class="nav-link" data-page="seasons">
            <span class="nav-icon">üóÇÔ∏è</span>
            <span>Seasons</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="devotees.html" class="nav-link" data-page="devotees">
            <span class="nav-icon">üë•</span>
            <span>Players</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="awards.html" class="nav-link" data-page="awards">
            <span class="nav-icon">üèÖ</span>
            <span>Awards</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
(function() {
  // Load site config and update header stats
  if (window.SITE_CONFIG) {
    document.getElementById('totalSeasons').textContent = window.SITE_CONFIG.seasons;
    document.getElementById('totalPlayers').textContent = window.SITE_CONFIG.players;
    document.getElementById('currentSeasonNum').textContent = window.SITE_CONFIG.currentSeason;
    document.getElementById('iconFormat').textContent = window.SITE_CONFIG.iconFormat;
  }

  // Scroll behavior
  const header = document.getElementById('modernHeader');
  if (!header) return;
  
  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;
    if (currentScroll > 20) {
      header.classList.add('scrolled');
    } else {
      header.classList.remove('scrolled');
    }
  }, { passive: true });

  // Active page highlighting
  const currentPage = window.location.pathname.split('/').pop() || 'index.html';
  const navLinks = document.querySelectorAll('.nav-link');
  
  navLinks.forEach(link => {
    const linkPage = link.getAttribute('href');
    if (linkPage === currentPage || (currentPage === '' && linkPage === 'index.html')) {
      link.classList.add('active');
    }
  });

  // Path resolution for nested folders
  const root = (document.documentElement.dataset.root || document.body.dataset.root || ".").replace(/\/+$/, "");
  
  if (root !== ".") {
    const allLinks = header.querySelectorAll('a[href]');
    allLinks.forEach(link => {
      const href = link.getAttribute('href');
      if (href && !href.startsWith('http') && !href.startsWith('#')) {
        link.setAttribute('href', root + '/' + href);
      }
    });
  }
})();
</script>
<!-- SITE HEADER END -->

<main style="min-height:100vh; padding-bottom:100px;">
  <div class="container">
    
    <div class="topbar">
      <div>
        <div class="brand">DC <span>Franchise</span> Database</div>
        <div class="meta">Dynamic player profiles ‚Ä¢ Powered by JSON ‚Ä¢ Search & sort enabled</div>
      </div>
      <div class="meta">40 total players ‚Ä¢ 68 appearances</div>
    </div>
    
   

    <div class="devotees-hero">
      <h1>üë• All Players</h1>
      <p>Browse the complete roster of Total Drama contestants</p>
    </div>

    <div class="controls">
      <div style="display:grid; grid-template-columns:2fr 1fr; gap:16px;">
        <input 
          type="search" 
          id="search" 
          placeholder="üîç Search players by name..." 
          style="padding:14px 20px; border-radius:14px; font-size:15px; width:100%; color:var(--text);"
        />
        <select 
          id="sort" 
          style="padding:14px 20px; border-radius:14px; font-size:15px; color:var(--text);"
        >
          <option value="place-asc">üìà Best Placement (1st ‚Üí Last)</option>
          <option value="place-desc">üìâ Worst Placement (Last ‚Üí 1st)</option>
          <option value="name-asc">üî§ Name (A ‚Üí Z)</option>
          <option value="name-desc">üî§ Name (Z ‚Üí A)</option>
        </select>
      </div>
    </div>

    <div id="count" style="margin:20px 0; font-size:14px; color:var(--muted);">
      Loading players...
    </div>

    <div class="grid" id="grid">
      <!-- Player cards will be inserted here by JavaScript -->
    </div>

    <div class="footer">40 total players across 4 seasons ‚Ä¢ 68 total appearances</div>
  </div>
</main>

<!-- SITE FOOTER START -->
<footer class="siteFooter">
  <div class="footerInner">
    <div class="footerTitle">DC Franchise Database</div>
    <div class="footerSub">Static archive ‚Ä¢ 5 seasons ‚Ä¢ 58 players ‚Ä¢ Icons: name.png</div>
  </div>
</footer>
<!-- SITE FOOTER END -->

<script>
const grid = document.getElementById('grid');
const search = document.getElementById('search');
const sortSelect = document.getElementById('sort');
const countDiv = document.getElementById('count');

let allPlayers = [];

// Player emoji mapping
const emojiMap = {
  'alejandro': 'üëë', 'lindsay': 'üíÅ', 'duncan': 'üíÄ', 'emma': 'üéØ', 'cameron': 'üß†',
  'bridgette': 'üèÑ', 'trent': 'üé∏', 'owen': 'üçî', 'heather': 'üíÖ', 'beth': 'üå∏',
  'gwen': 'üé®', 'courtney': 'üìã', 'noah': 'üìö', 'ezekiel': 'üèîÔ∏è', 'geoff': 'üéâ',
  'zoey': '‚ù§Ô∏è', 'scott': 'üöú', 'mike': 'üé≠', 'anne maria': 'üíÑ', 'brick': 'üéñÔ∏è',
  'dwayne': 'üë®‚Äçüë¶', 'jo': 'üí™', 'dakota': '‚ú®', 'dawn': 'üåø', 'b': 'üîß',
  'sam': 'üéÆ', 'lightning': '‚ö°', 'staci': 'üí¨', 'crimson': 'üñ§', 'harold': 'ü§ì',
  'leshawna': 'üíÅ', 'justin': 'üòé', 'katie': 'üíñ', 'sadie': 'üíñ', 'izzy': 'ü§™',
  'cody': 'üò¨', 'eva': 'üò†', 'tyler': 'üèÄ', 'sierra': 'üì±',
  'amy': 'üòà', 'samey': 'üòä', 'scarlett': 'üß™', 'shawn': 'üßü', 'topher': 'üì∫',
  'rodney': 'üíò', 'dave': 'üò§', 'josee': '‚õ∑Ô∏è', 'max': 'ü¶π', 'mickey': 'üê≠',
  'sky': 'ü•ã', 'sugar': 'üç≠', 'beardo': 'üéµ', 'blaineley': 'üé§', 'ella': 'üé∂',
  'jasmine': 'üåø', 'leonard': 'ü™Ñ', 'ryan': 'üèãÔ∏è',
  'mary': 'üß©',
  'brody': 'üèÑ',
  'kitty': 'üì∏',
  'junior': 'üßí',
  'ennui': 'ü´•',
  'jacques': 'üï∫',
  'jay': 'üß¢',
  'stephanie': 'üò§',
  'kelly': 'üëú',
  'tammy': 'ü™Ñ'
};


// ========================================
// UPDATED DEVOTEES.HTML SCRIPT
// Replace the fetch() section in devotees.html (around line 509-526) with this:
// ========================================

// Load player data from localStorage first, fallback to JSON
function loadPlayerData() {
  // Try localStorage first (synced from current-season.html)
  try {
    const stored = localStorage.getItem('players_database');
    if (stored) {
      const data = JSON.parse(stored);
      console.log('‚úÖ Loaded player data from localStorage');
      return Promise.resolve(data);
    }
  } catch (e) {
    console.warn('Could not load from localStorage:', e);
  }
  
  // Fallback to JSON file
  console.log('üìÅ Loading from players_database.json...');
  return fetch('players_database.json')
    .then(response => response.json())
    .catch(error => {
      console.error('Error loading player data:', error);
      throw error;
    });
}

loadPlayerData()
  .then(data => {
    allPlayers = data.players.map(player => {
      const emoji = emojiMap[player.name.toLowerCase()] || 'üë§';
      return {
        ...player,
        emoji: emoji
      };
    });
    renderPlayers(allPlayers);
    updateDisplay();
    
    // Show data source indicator
    const stored = localStorage.getItem('players_database');
    if (stored) {
      console.log('üîÑ Data synced from current-season.html');
    }
  })
  .catch(error => {
    console.error('Failed to load player data:', error);
    countDiv.textContent = '‚ùå Error loading players. Check console.';
  });

function renderPlayers(players) {
  grid.innerHTML = '';
  
  players.forEach(player => {
    const card = document.createElement('a');
    card.className = 'card' + (player.wins > 0 ? ' winner' : '');
    card.href = `player.html?player=${player.id}`;
    card.setAttribute('data-name', player.name.toLowerCase());
    card.setAttribute('data-place', player.bestPlacement);
    
    // Build season summary
    const seasonSummary = player.seasonDetails
      .sort((a, b) => a.season - b.season)
      .map(s => `S${s.season}: #${s.placement}`)
      .join(' ‚Ä¢ ');
    
    // Build badges
    let badgesHtml = '';
    
    // Add special badges
    if (player.wins > 0) {
      const winSeason = player.seasonDetails.find(s => s.placement === 1);
      badgesHtml += `<span class="badge gold">üèÜ Season ${winSeason.season} Winner</span>`;
    }
    
    // Add key badges from player.badges array
    if (player.badges && player.badges.length > 0) {
      player.badges.slice(0, 2).forEach(badge => {
        let badgeClass = 'badge';
        if (badge.includes('Strategic') || badge.includes('Social')) badgeClass += ' purple';
        else if (badge.includes('Fan Favorite') || badge.includes('FAN FAVORITE')) badgeClass += ' purple';
        else if (badge.includes('Perfect') || badge.includes('Unbreakable')) badgeClass += ' good';
        badgesHtml += `<span class="${badgeClass}">${badge}</span>`;
      });
    }
    
    // Add basic badges
    badgesHtml += `<span class="badge">Best: #${player.bestPlacement}</span>`;
    badgesHtml += `<span class="badge">${player.totalSeasons} season${player.totalSeasons > 1 ? 's' : ''}</span>`;
    
    card.innerHTML = `
      <div class="row">
        <div class="player-avatar">
          <img src="assets/avatars/${player.id}.png" alt="${player.name}" onload="this.style.display='block';" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"/>
          <div class="fallback">${player.emoji}</div>
        </div>
        <div>
          <div class="name">${player.emoji} ${player.name}</div>
          <div class="sub">${seasonSummary}</div>
        </div>
      </div>
      <div class="badges">
        ${badgesHtml}
      </div>
    `;
    
    grid.appendChild(card);
  });
}

function updateDisplay() {
  const query = search.value.toLowerCase();
  const sortValue = sortSelect.value;
  
  const cards = Array.from(grid.querySelectorAll('.card'));
  
  let filtered = cards.filter(c => {
    const name = c.getAttribute('data-name');
    return name.includes(query);
  });
  
  filtered.sort((a, b) => {
    const aPlace = parseInt(a.getAttribute('data-place'));
    const bPlace = parseInt(b.getAttribute('data-place'));
    const aName = a.getAttribute('data-name');
    const bName = b.getAttribute('data-name');
    
    if (sortValue === 'place-asc') return aPlace - bPlace;
    if (sortValue === 'place-desc') return bPlace - aPlace;
    if (sortValue === 'name-asc') return aName.localeCompare(bName);
    if (sortValue === 'name-desc') return bName.localeCompare(aName);
    return 0;
  });
  
  // Hide all cards first
  cards.forEach(c => c.style.display = 'none');
  
  // Show filtered cards in sorted order
  grid.innerHTML = '';
  filtered.forEach(c => {
    c.style.display = 'block';
    grid.appendChild(c);
  });
  
  countDiv.textContent = `Showing ${filtered.length} of ${allPlayers.length} players`;
}

search.addEventListener('input', updateDisplay);
sortSelect.addEventListener('change', updateDisplay);
</script>

</body>
</html>
